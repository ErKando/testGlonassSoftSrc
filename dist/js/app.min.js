(()=>{"use strict";const t=document.querySelector("#table-row-tmp");class s{constructor(s){this.box=document.querySelector(s),this.boxInner=this.box.querySelector(".table__inner"),this.addBtn=this.box.querySelector(".table__btn--add"),this.forms=this.box.querySelectorAll("form"),this.btns=this.boxInner.querySelectorAll("button"),this.x=[],this.y=[],this.listenForms(),this.setIdBtn(),this.addBtn&&this.addBtn.addEventListener("click",(()=>{const s=t.content.cloneNode(!0);this.boxInner.appendChild(s),this.listenForms(),this.setIdBtn()})),this.boxInner.addEventListener("click",(t=>{t.target.classList.contains("js-remove")&&(this.boxInner.removeChild(t.target.parentNode),this.x.splice(t.target.dataset.id,1),this.y.splice(t.target.dataset.id,1),d(),this.setIdBtn())}))}listenForms(){this.forms=this.box.querySelectorAll("form"),this.forms.forEach(((t,s)=>{t.addEventListener("input",(()=>{this.x[s]=t.querySelectorAll("input")[0].value,this.y[s]=t.querySelectorAll("input")[1].value}))}))}setIdBtn(){this.boxInner.querySelectorAll("button").forEach(((t,s)=>{t.dataset.id=s}))}}class i{constructor(t){this.box=document.querySelector(t),this.canvasLine=this.box.querySelectorAll("canvas")[0],this.canvasLineContext=this.canvasLine.getContext("2d"),this.canvasLineContext.strokeStyle="#1E2C3D",this.canvasRisk=this.box.querySelectorAll("canvas")[1],this.canvasRiskContext=this.canvasRisk.getContext("2d"),this.canvasRiskContext.strokeStyle="#C5C5C5",this.dotsField=this.box.querySelector(".chart__dots-field"),this.riskFeild=this.box.querySelector(".risks"),this.maxX,this.minX,this.maxAbsX,this.maxY,this.minY,this.maxAbsY,this.dot,this.dotTooltip,this.pointX,this.pointY,this.riskLabelX,this.riskLabelY}clearAll(){this.riskFeild.innerHTML="",this.dotsField.innerHTML="",this.canvasLineContext.clearRect(0,0,this.canvasLine.width,this.canvasLine.height),this.canvasRiskContext.clearRect(0,0,this.canvasRisk.width,this.canvasRisk.height)}creatDot(t,s){this.dot=document.createElement("div"),this.dot.classList.add("chart__dot"),this.dot.style.right=(100-+t.x[s]/(1.1*this.maxAbsX)*100)/2+"%",this.dot.style.top=(100-+t.y[s]/(1.1*this.maxAbsY)*100)/2+"%",this.dotTooltip=document.createElement("div"),this.dotTooltip.classList.add("chart__dot-tooltip"),this.dotTooltip.innerHTML=`X: ${t.x[s]} <br> Y: ${t.y[s]}`,this.dot.appendChild(this.dotTooltip),this.dotsField.appendChild(this.dot)}setPoints(t,s){this.pointX=253-(100-+t.x[s]/(1.1*this.maxAbsX)*100)/2/100*253,this.pointY=(100-+t.y[s]/(1.1*this.maxAbsY)*100)/2/100*253}drawRisks(t,s){this.canvasRiskContext.beginPath(),this.canvasRiskContext.moveTo(123,this.pointY),this.canvasRiskContext.lineTo(130,this.pointY),this.canvasRiskContext.closePath(),this.canvasRiskContext.stroke(),this.canvasRiskContext.beginPath(),this.canvasRiskContext.moveTo(this.pointX,123),this.canvasRiskContext.lineTo(this.pointX,130),this.canvasRiskContext.closePath(),this.canvasRiskContext.stroke(),this.riskLabelY=document.createElement("div"),this.riskLabelY.classList.add("risks__labelY"),this.riskLabelY.style.right="50%",this.riskLabelY.style.top=this.dot.style.top,this.riskLabelY.textContent=`${t.y[s]}`,this.riskFeild.appendChild(this.riskLabelY),this.riskLabelX=document.createElement("div"),this.riskLabelX.classList.add("risks__labelX"),this.riskLabelX.style.right=this.dot.style.right,this.riskLabelX.style.top="50%",this.riskLabelX.textContent=`${t.x[s]}`,this.riskFeild.appendChild(this.riskLabelX)}startLine(){this.canvasLineContext.beginPath(),this.canvasLineContext.moveTo(this.pointX,this.pointY)}endLine(){this.canvasLineContext.lineTo(this.pointX,this.pointY),this.canvasLineContext.closePath(),this.canvasLineContext.stroke()}setXandY(t){this.maxX=t.x.map(parseFloat).sort(((t,s)=>s-t))[0],this.minX=t.x.map(parseFloat).sort(((t,s)=>t-s))[0],this.maxAbsX=Math.abs(this.maxX)>Math.abs(this.minX)?Math.abs(this.maxX):Math.abs(this.minX),this.maxY=t.y.map(parseFloat).sort(((t,s)=>s-t))[0],this.minY=t.y.map(parseFloat).sort(((t,s)=>t-s))[0],this.maxAbsY=Math.abs(this.maxY)>Math.abs(this.minY)?Math.abs(this.maxY):Math.abs(this.minY)}}const e=new s(".table--1"),a=new s(".table--2"),n=new i(".chart1"),h=new i(".chart2"),o=new class extends i{constructor(t){super(t)}setXandY(t,s){this.maxX=(t.maxX+s.maxX)/2,this.minX=(t.minX+s.minX)/2,this.maxAbsX=Math.abs(this.maxX)>Math.abs(this.minX)?Math.abs(this.maxX):Math.abs(this.minX),this.maxY=(t.maxY+s.maxY)/2,this.minY=(t.minY+s.minY)/2,this.maxAbsY=Math.abs(this.maxY)>Math.abs(this.minY)?Math.abs(this.maxY):Math.abs(this.minY)}creatDot(t,s,i){this.dot=document.createElement("div"),this.dot.classList.add("chart__dot"),this.dot.style.right=(100-(+t.x[i]+ +s.x[i])/2/(1.1*this.maxAbsX)*100)/2+"%",this.dot.style.top=(100-(+t.y[i]+ +s.y[i])/2/(1.1*this.maxAbsY)*100)/2+"%",this.dotTooltip=document.createElement("div"),this.dotTooltip.classList.add("chart__dot-tooltip"),this.dotTooltip.innerHTML=`X: ${(+t.x[i]+ +s.x[i])/2} <br> Y: ${(+t.y[i]+ +s.y[i])/2}`,this.dot.appendChild(this.dotTooltip),this.dotsField.appendChild(this.dot)}setPoints(t,s,i){this.pointX=253-(100-(+t.x[i]+ +s.x[i])/2/(1.1*this.maxAbsX)*100)/2/100*253,this.pointY=(100-(+t.y[i]+ +s.y[i])/2/(1.1*this.maxAbsY)*100)/2/100*253}drawRisks(t,s,i){this.canvasRiskContext.beginPath(),this.canvasRiskContext.moveTo(123,this.pointY),this.canvasRiskContext.lineTo(130,this.pointY),this.canvasRiskContext.closePath(),this.canvasRiskContext.stroke(),this.canvasRiskContext.beginPath(),this.canvasRiskContext.moveTo(this.pointX,123),this.canvasRiskContext.lineTo(this.pointX,130),this.canvasRiskContext.closePath(),this.canvasRiskContext.stroke(),this.riskLabelY=document.createElement("div"),this.riskLabelY.classList.add("risks__labelY"),this.riskLabelY.style.right="50%",this.riskLabelY.style.top=this.dot.style.top,this.riskLabelY.textContent=""+(+t.y[i]+ +s.y[i])/2,this.riskFeild.appendChild(this.riskLabelY),this.riskLabelX=document.createElement("div"),this.riskLabelX.classList.add("risks__labelX"),this.riskLabelX.style.right=this.dot.style.right,this.riskLabelX.style.top="50%",this.riskLabelX.textContent=""+(+t.x[i]+ +s.x[i])/2,this.riskFeild.appendChild(this.riskLabelX)}}(".chart3"),l=document.querySelector(".table--3"),r=l.querySelector(".table__result"),c=document.querySelector("#table-row-tmp--calc"),d=()=>{r.innerHTML="";let t=e.x.length>=a.x.length?a.x.length:e.x.length;n.clearAll(),h.clearAll(),o.clearAll(),n.setXandY(e),h.setXandY(a),o.setXandY(n,h);for(let s=0;s<t;s++){let t=c.content.cloneNode(!0);t.querySelectorAll("input")[0].value=(+e.x[s]+ +a.x[s])/2,t.querySelectorAll("input")[1].value=(+e.y[s]+ +a.y[s])/2,l.querySelector(".table__result").appendChild(t),n.creatDot(e,s),h.creatDot(a,s),o.creatDot(e,a,s),n.setPoints(e,s),h.setPoints(a,s),o.setPoints(e,a,s),n.drawRisks(e,s),h.drawRisks(a,s),o.drawRisks(e,a,s),s>0&&(n.endLine(),h.endLine(),o.endLine()),n.startLine(),h.startLine(),o.startLine()}};l.addEventListener("click",(function(t){t.target.classList.contains("table__btn--calc")&&d()}))})();